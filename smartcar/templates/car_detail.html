{% load static %}
<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js" integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30=" crossorigin="anonymous"></script>
<script src="{% static 'js/car_information.js' %}"></script>
<script src="{% static 'js/port_map.js' %}"></script>
{% if user.is_authenticated %}
    {% else %}
        <script>
        window.location.href =  "{% url 'auth' %}";
        </script>
{% endif %}

{% if request.user.is_staff %}
관리자모드
{% endif %}
<br>
<a href="/main">메인으로가기</a><br>
<input type="hidden" id="test" value="{{ carNumber }}">
<div>{{ carNumber }}</div>
<div id="container"></div>
<div id="destination"></div>
<div id="route"></div>
<div id="speed"></div>
<div id="battery"></div>
<div id="communication"></div>
<div id="drivingmode"></div>

<div id="map"></div>
<!--<button id="path_search" value="경로찾기" onclick="search()"></button>-->
<!--<div id="path"></div>-->
<button id="go" onclick="go()">직진</button>
<button id="back" onclick="back()">후진</button>
<button id="right" onclick="right()">우회전</button>
<button id="left" onclick="left()">좌회전</button>

<script>
function go(){
        $.ajax({
            type : 'POST',
            url : 'http://127.0.0.1:8000/main/go',
            dataType:'json',
            data : {
                aaa : '1',
                bbb : '2'
            },
            success: function(data){
            console.log('go');
            }
        });
}
function back(){
        $.ajax({
            type : 'POST',
            url : 'http://127.0.0.1:8000/main/back',
            dataType:'json',
            data : {
                aaa : '1',
                bbb : '2'
            },
            success: function(data){
            console.log('back');
            }
        });
}
function right(){
        $.ajax({
            type : 'POST',
            url : 'http://127.0.0.1:8000/main/right',
            dataType:'json',
            data : {
                aaa : '1',
                bbb : '2'
            },
            success: function(data){
            console.log('right');
            }
        });
}
function left(){
        $.ajax({
            type : 'POST',
            url : 'http://127.0.0.1:8000/main/left',
            dataType:'json',
            data : {
                aaa : '1',
                bbb : '2'
            },
            success: function(data){
            console.log('left');
            }
        });
}
<!--function search(){-->
      <!--$.ajax({-->
                 <!--url : "http://127.0.0.1:8000/main/search_path",-->
                 <!--dataType : 'json',-->
                 <!--success : function (data) {-->
                 <!--});-->
                 <!--}-->
      <!--});-->
<!--}-->


    var filtered_json = new Array();
    $.ajax({
                 url : "http://127.0.0.1:8000/api/CarInfo/?format=json",
                 dataType : 'json',
                 success : function (data) {
                    var my_json = JSON.stringify(data)
                    filtered_json = find_in_object(JSON.parse(my_json), {carnumber: {{ carNumber }} });
                    var container = filtered_json[0].container;
                    var destination = filtered_json[0].destination;
                    var route = filtered_json[0].route;
                    var speed = filtered_json[0].speed;
                    var battery = filtered_json[0].battery;
                    var communication = filtered_json[0].communication;
                    var drivingmode = filtered_json[0].drivingmode;
                    $("#container").text(container);
                    $("#route").text(route);
                    $("#speed").text(speed);
                    $("#battery").text(battery);
                    $("#destination").text(destination);
                    $("#communication").text(communication);
                    $("#drivingmode").text(drivingmode);
                 }
      });


function find_in_object(my_object, my_criteria){
  return my_object.filter(function(obj) {
    return Object.keys(my_criteria).every(function(c) {
      return obj[c] == my_criteria[c];
    });
  });
}
</script>
